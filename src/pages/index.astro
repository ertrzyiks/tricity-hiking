---
import Layout from '../layouts/Layout.astro';
import { merge } from '../geodata/merge'
import { enhance } from '../geodata/enhance'
import { getCollection, getEntry } from 'astro:content';

import mapImage from '../assets/home-map.jpg'
import { HomeMap } from '../components/HomeMap/HomeMap';

const routes = await getCollection('routes');

const geojsonList = []

for (const route of routes) {
  const geojson = await getEntry(route.data.geojson)
  const enhancedGeojson = enhance({ collection: geojson.data, route: route.data })
  geojsonList.push(enhancedGeojson)
}

const geojson = merge(geojsonList)
---

<Layout title="Tricity hiking">

  <div class="max-w-screen-xl mx-auto py-8">
    Tricity is a metropolitan area consisting of three cities in Pomerania, Poland: Gda≈Ñsk, Gdynia, and Sopot.
    The area is a popular tourist destination, and it is known for its beaches, parks, and historical sites.
    One of the best ways to explore the area is by hiking, and there are many beautiful trails to choose from.
    Whether you are looking for a leisurely walk or a challenging hike,
    you will find something to suit your needs in Tricity.
  </div>

  <div class="max-w-screen-xl mx-auto relative h-[80vh] px-2 lg:px-0">
    <div class="absolute inset-0 h-full overflow-hidden">
      <img src={mapImage.src} class="absolute blur-2xl inset-0 h-full" />
    </div>

    <HomeMap client:only="preact" routes={geojson} />
  </div>
</Layout>

<style is:global>
  .maplibregl-map {
    height: 100%;
    width: 100%;
  }
</style>
